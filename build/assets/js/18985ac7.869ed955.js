"use strict";(self.webpackChunkmaterial=self.webpackChunkmaterial||[]).push([[1871],{8453:(e,a,o)=>{o.d(a,{R:()=>i,x:()=>t});var n=o(6540);const s={},r=n.createContext(s);function i(e){const a=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function t(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),n.createElement(r.Provider,{value:a},e.children)}},9808:(e,a,o)=>{o.r(a),o.d(a,{assets:()=>c,contentTitle:()=>t,default:()=>u,frontMatter:()=>i,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"Criptografia/AlgoritmosHash/hmaceJWT","title":"hmaceJWT","description":"HMAC e JWT \u2014 Quando assinar \xe9 mais importante que esconder","source":"@site/docs/Criptografia/AlgoritmosHash/hmaceJWT.md","sourceDirName":"Criptografia/AlgoritmosHash","slug":"/Criptografia/AlgoritmosHash/hmaceJWT","permalink":"/material/Criptografia/AlgoritmosHash/hmaceJWT","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Criptografia/AlgoritmosHash/hmaceJWT.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"SHA","permalink":"/material/Criptografia/AlgoritmosHash/SHA"},"next":{"title":"Hardware e Criptografia?","permalink":"/material/Criptografia/Hardware/"}}');var s=o(4848),r=o(8453);const i={},t=void 0,c={},d=[];function m(e){const a={p:"p",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.p,{children:"HMAC e JWT \u2014 Quando assinar \xe9 mais importante que esconder\nVamos come\xe7ar com uma pergunta simples, mas essencial:\nComo voc\xea garante que uma mensagem veio de quem deveria vir e n\xe3o foi alterada no caminho?"}),"\n",(0,s.jsx)(a.p,{children:"Voc\xea poderia criptografar, certo? Mas nem sempre criptografia \xe9 a resposta certa. \xc0s vezes, o que voc\xea quer \xe9 garantir a integridade da mensagem \u2014 e autenticar sua origem \u2014 sem necessariamente escond\xea-la."}),"\n",(0,s.jsx)(a.p,{children:"E \xe9 a\xed que entra o HMAC.\nE logo depois dele, o JWT."}),"\n",(0,s.jsx)(a.p,{children:"HMAC: integridade e autenticidade na veia\nO HMAC (Hash-based Message Authentication Code) \xe9 tipo aquele carimbo digital que voc\xea coloca numa mensagem para garantir duas coisas:"}),"\n",(0,s.jsx)(a.p,{children:"Ningu\xe9m mexeu na mensagem desde que ela saiu de voc\xea"}),"\n",(0,s.jsx)(a.p,{children:"A mensagem veio de quem diz ter vindo"}),"\n",(0,s.jsx)(a.p,{children:"Como ele faz isso?\nCom uma fun\xe7\xe3o de hash (como SHA-256) combinada com uma chave secreta compartilhada entre as partes."}),"\n",(0,s.jsx)(a.p,{children:"Pensa assim: \xe9 como se a mensagem fosse passada por uma prensa que imprime uma marca invis\xedvel, mas que s\xf3 quem tem a tinta certa (a chave secreta) consegue gerar. Qualquer tentativa de falsificar ou modificar a mensagem quebra a assinatura."}),"\n",(0,s.jsx)(a.p,{children:"Como o HMAC funciona?\nEle \xe9 inteligente \u2014 e mais elaborado do que simplesmente fazer SHA256(chave + mensagem) (que, por sinal, seria uma p\xe9ssima ideia)."}),"\n",(0,s.jsx)(a.p,{children:"A estrutura:\nA chave \xe9 combinada com um inner pad (ipad)."}),"\n",(0,s.jsx)(a.p,{children:"Essa combina\xe7\xe3o \xe9 concatenada com a mensagem e passada pela fun\xe7\xe3o de hash."}),"\n",(0,s.jsx)(a.p,{children:"O resultado \xe9 concatenado com a chave + outer pad (opad)."}),"\n",(0,s.jsx)(a.p,{children:"Tudo isso \xe9 passado de novo pela fun\xe7\xe3o de hash."}),"\n",(0,s.jsx)(a.p,{children:"Em nota\xe7\xe3o formal:"}),"\n",(0,s.jsx)(a.p,{children:"mathematica\nCopiar\nEditar\nHMAC(K, M) = H((K \u2295 opad) \u2225 H((K \u2295 ipad) \u2225 M))\nEssa \u201cdupla camada\u201d serve para proteger contra ataques conhecidos \xe0s fun\xe7\xf5es de hash (tipo o length extension attack, comum com SHA-1 ou MD5)."}),"\n",(0,s.jsx)(a.p,{children:"A beleza do HMAC \xe9 que, mesmo que o hash em si tenha fraquezas, o uso da chave secreta e do padding dificulta bastante a vida do atacante."}),"\n",(0,s.jsx)(a.p,{children:"E onde isso entra no mundo real?\nEntra aqui: JWT \u2014 JSON Web Token"}),"\n",(0,s.jsx)(a.p,{children:"JWT: o crach\xe1 do usu\xe1rio moderno\nO JWT \xe9 como um crach\xe1 digital.\nQuando o usu\xe1rio faz login, o sistema gera um token com informa\xe7\xf5es codificadas sobre ele \u2014 e assina isso com HMAC. O resultado? Um pacote leve, seguro e autocontido que o cliente pode carregar com ele."}),"\n",(0,s.jsx)(a.p,{children:"Um token t\xedpico tem essa estrutura:"}),"\n",(0,s.jsx)(a.p,{children:"nginx\nCopiar\nEditar\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9\n.\neyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvZSIsImlhdCI6MTUxNjIzOTAyMn0\n.\nSflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c\nS\xe3o tr\xeas partes separadas por ponto:"}),"\n",(0,s.jsx)(a.p,{children:"Header \u2013 que diz \u201cestou usando HMAC-SHA256\u201d"}),"\n",(0,s.jsx)(a.p,{children:"Payload \u2013 que cont\xe9m claims como ID do usu\xe1rio, tempo de expira\xe7\xe3o, permiss\xf5es"}),"\n",(0,s.jsx)(a.p,{children:"Signature \u2013 que \xe9 o HMAC de tudo isso, usando a chave secreta"}),"\n",(0,s.jsx)(a.p,{children:"No lado do servidor, ao receber esse token em uma requisi\xe7\xe3o, ele refaz a assinatura e compara com a recebida. Se bateu, est\xe1 tudo certo. Se n\xe3o bateu, algu\xe9m tentou falsificar."}),"\n",(0,s.jsx)(a.p,{children:"Mas tem um detalhe importante...\nJWTs n\xe3o s\xe3o criptografados por padr\xe3o.\nOu seja, qualquer um pode decodificar e ler o conte\xfado do token (header e payload).\nMas ningu\xe9m pode modific\xe1-lo sem invalidar a assinatura, a menos que tenha a chave secreta."}),"\n",(0,s.jsx)(a.p,{children:"Se voc\xea precisa de sigilo, a\xed entra o JWE (JSON Web Encryption) \u2014 que encapsula o JWT numa estrutura criptografada. Mas se o foco \xe9 autentica\xe7\xe3o e integridade, o bom e velho HMAC no JWT d\xe1 conta do recado."}),"\n",(0,s.jsx)(a.p,{children:"Aplica\xe7\xf5es pr\xe1ticas\nVoc\xea encontra HMAC + JWT em praticamente qualquer sistema web moderno:"}),"\n",(0,s.jsx)(a.p,{children:"APIs RESTful com autentica\xe7\xe3o stateless"}),"\n",(0,s.jsx)(a.p,{children:"Sistemas de login onde o servidor n\xe3o mant\xe9m sess\xe3o"}),"\n",(0,s.jsx)(a.p,{children:"Tokens de autentica\xe7\xe3o em SPAs (Single Page Applications)"}),"\n",(0,s.jsx)(a.p,{children:"Integra\xe7\xf5es com OAuth2 e OpenID Connect"}),"\n",(0,s.jsx)(a.p,{children:"Verifica\xe7\xe3o de integridade de mensagens ass\xedncronas"}),"\n",(0,s.jsx)(a.p,{children:"Tudo isso rodando, confiando que a assinatura foi gerada com a chave correta, e que ningu\xe9m meteu a m\xe3o no caminho."}),"\n",(0,s.jsx)(a.p,{children:"Vulnerabilidades? Sim. Mas evit\xe1veis.\nHMAC \xe9 seguro, mas implementa\xe7\xe3o importa. Aqui v\xe3o alguns erros cl\xe1ssicos:"}),"\n",(0,s.jsx)(a.p,{children:"Chave fraca ou previs\xedvel \u2192 qualquer um pode gerar tokens v\xe1lidos."}),"\n",(0,s.jsx)(a.p,{children:"Chave exposta no frontend \u2192 n\xe3o precisa nem de for\xe7a bruta."}),"\n",(0,s.jsx)(a.p,{children:"Aceitar alg: none no header \u2192 cl\xe1ssico ataque onde o servidor simplesmente n\xe3o verifica a assinatura."}),"\n",(0,s.jsx)(a.p,{children:"N\xe3o validar a expira\xe7\xe3o (exp) \u2192 tokens v\xe1lidos para sempre. Parab\xe9ns, voc\xea criou um backdoor."}),"\n",(0,s.jsx)(a.p,{children:"O segredo do sucesso com JWT + HMAC est\xe1 em validar tudo com crit\xe9rio."}),"\n",(0,s.jsx)(a.p,{children:"Resumo da \xf3pera\nComponente\tFun\xe7\xe3o\nHMAC\tGarante integridade + autenticidade da mensagem\nJWT\tEstrutura leve para transportar informa\xe7\xf5es com assinatura digital"}),"\n",(0,s.jsx)(a.p,{children:"Juntos, formam um dos pilares da seguran\xe7a moderna em aplica\xe7\xf5es web."}),"\n",(0,s.jsx)(a.p,{children:"Voc\xea pode pensar no HMAC como o carimbo digital.\nE no JWT como o envelope lacrado com esse carimbo."}),"\n",(0,s.jsx)(a.p,{children:"N\xe3o \xe9 blindado \u2014 qualquer um pode ler \u2014 mas s\xf3 quem tem o selo certo consegue lacrar de novo."})]})}function u(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}}}]);